\chapter{Introduction}
% Insère le titre du chapitre dans la table des matières (à cause du '*', n'est pas fait automatiquement)
%\addstarredchapter{Introduction} % On utilise addstarredchapter et non addcontentsline pour eviter les pbs avec minitoc
\defineHeaderForStarredChapter[Introduction] % Ici, il faut le mettre après la définition du chapitre. Il semblerait que ce soit dû à un conflit avec \listof*
\graphicspath{{images/Introduction/}}
% On passe en chiffre arabe pour le contenu
\pagenumbering{arabic}

Cette thèse a été effectuée entre novembre 2014 et novembre 2017 au Laboratoire Vision et Ingénierie des Contenus (LVIC) du CEA LIST, à Saclay. L'ensemble des travaux ont été réalisés en cotutelle avec l'unité de recherche ISIT (Institut des Sciences de l'Image pour les Techniques interventionnelles, UMR 6284 UdA, CNRS) à Clermont-Ferrand.

\section*{Contexte}

Dans le cadre de cette thèse, nous nous attachons à la conception d'un modèle géométrique pour améliorer le rendu des applications de réalité augmentée. La réalité augmentée consiste en l'insertion d'éléments virtuels (que nous appellerons augmentations) dans la réalité grâce à un écran. Au moment de la rédaction de ce mémoire, les applications scientifiques, industrielles et commerciales de la réalité augmentée ont fortement augmentée notamment grâce à l'essor des méthodes d'affichage comme le casque Hololens de Microsoft\footnote{https://www.microsoft.com/en-us/hololens} et les kits de développement de réalité augmentée sur smartphone d'Apple (Arkit\footnote{https://developer.apple.com/arkit/}) et Android (Arcore\footnote{https://developers.google.com/ar/}). Les évolutions dans le domaine de la localisation de caméra permettent une industrialisation d'applications plus ambitieuses comme illustré à la figure \ref{fig:applications_ra}:
\begin{itemize}
    \item aide à la vente : la visualisation immédiate des différentes configurations possibles
d'un produit (par exemple une voiture, un meuble, \ldots) sans contrainte de
stock, pourrait aider le choix de l'utilisateur et contribuer à une vente réussie
tout en réduisant les coûts associés aux points de vente ;
    \item aide à la maintenance : les systèmes industriels complexes nécessitent des procédures
de maintenance complexes, la réalité augmentée pourrait simplifier la
formation des techniciens et augmenter la sécurité en affichant les instructions
pas à pas sur le système réel ;
    \item aide à la navigation : que ce soit à l'intérieur ou à l'extérieur, un « GPS amélioré
» pourrait être utile : permettant de signaler précisément l'itinéraire à
suivre et d'autres informations importantes ainsi que les dangers imminents ;
    \item aide à la chirurgie : la plupart des opérations lourdes font l'objet d'une acquisition
3D préliminaire des organes concernés (scanner, \ldots), l'affichage de
ces informations directement sur le patient en réalité augmentée pourrait
grandement aider le praticien en le guidant vers la zone à traiter et en mettant en évidence les zones à éviter, par exemple les artères et les nerfs.
\end{itemize}
\begin{figure}
\centering
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{refurnishing.png}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{selltic.jpg}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{hololens.jpg}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{ar-surg.jpg}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{fuvoria.jpg}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.3\linewidth]{pokemongo.jpg}
	}
\caption{Diverses applications de réalité augmentée : Aide à la vente immobilière (a) et automobile (b), aide à la formation médicale et à la chirurgie
 aide à la chirurgie (c, d), information complémentaire sur un objet (e) et jeu vidéo (f).}
\label{fig:applications_ra}
\end{figure}

Un système de réalité augmentée est complexe et fait intervenir des composants
variés, que l'on peut classer en trois briques principales : reconstruction, localisation
et affichage. Dans ce mémoire, nous nous concentrerons sur les problématiques d'affichage et plus particulièrement sur l'amélioration du rendu des applications de réalité augmentée. Cette amélioration se fait par l'utilisation d'un nouveau modèle géométrique permettant la prédiction de spécularités en temps réel pour un point de vue donné. Ce modèle a fait l'objet de plusieurs itérations afin d'augmenter les performances et la généricité du modèle.
Le chapitre \ref{chapitre:notions_de_base} introduit les notions de base utiles à la compréhension du mémoire : mathématiques (algèbre, géométrie projective, coniques, quadriques, courbure), vision par ordinateur (localisation, reconstruction, mise en correspondance d'images), modélisation de l'illumination (globale, locale et autres) et optimisation numérique. Nous détaillons le positionnement de notre modèle géométrique de prédiction de spécularité par rapport à l'état de l'art dans le chapitre \ref{chapitre:etat_de_lart}.

\section*{Problématique} 

Le chapitre \ref{chapitre:primal_jolimas} est dédié à l'introduction de notre modèle géométrique appelée \textit{JOint LIght Material-Specularity} (JOLIMAS) pour la prédiction de spécularités. Ces éléments sont primordiaux dans le réalisme des applications de réalité augmentée car ils participent activement au processus de perception humaine de la courbure d'un objet, du type de matériau de l'objet comme expliqué par \cite{blake1990does}. Cependant ce phénomène photométrique est complexe car il est décrit par nombreux paramètres (couleur, forme, position) et dépend de nombreux facteurs externes (géométrie de la scène, matériau de la surface, paramètres de caméras comme le temps exposition ou l'ouverture de l'objectif). Afin de simplifier la problématique, nous nous sommes restreint au cas de surface planes avec connaissance de la pose de la caméra par la méthode de \cite{tamaazousti2011nonlinear} et plus récemment de \cite{loesch2015generic}. Sur ces surfaces, nous avons observé que les spécularités conservaient une forme elliptique et plus généralement de conique. De plus, une source lumière ne produit qu'une seule spécularité sur une surface plane ce qui permet un meilleur suivi de la spécularité tout le long de la vidéo. De ce constat, une question subsiste : sachant qu'une spécularité représente la réflexion d'une lumière fixe, existe-il une forme 3D fixe dans l'espace tel que la projection de cette forme 3D correspond aux spécularités ?
Pour répondre à ce problème nous introduisons les contributions suivantes :
\begin{itemize}
\item Un détecteur de spécularité temps réel à partir d'une image (présenté en annexe \ref{annexe:specularity_detection})
\item JOLIMAS : Un modèle géométrique représentant la spécularité comme étant la projection perspective d'un objet 3D dans l'espace sur des surfaces planes pour gérant les sources de lumière ponctuelles (ampoules) mais aussi étendues (néons).
\item Une processus de prédiction de spécularité pour un nouveau point de vue.
\item Un processus de suivi de spécularité permettant une prédiction de spécularité dans un environnement multi-lumière.
\item Une application de retexturing permettant de changer une texture par une autre en simulant synthétiquement la spécularité supprimée.
\end{itemize}
Ces contributions ont fait l'objet de deux publications en conférence internationale :  VISAPP \citeyearpar{morgand2014generic}, ISMAR \citeyearpar{morgand2016geometric}, deux conférences nationales : deux articles à ORASIS \citeyearpar{morgand2015detection} et \citeyearpar{morgand2015reconstruction}, RFIA \citeyearpar{morgand2015modele} et un brevet accepté en juin 2016 \fix{Lien}.

%A partir d'une méthode de localisation de caméra \cite{tamaazousti2011nonlinear} et plus récemment \cite{loesch2015generic} fournissant la pose de caméra à partir d'un maillage connue d'un objet de la scène, nous reconstruisons un objet 3D sous la forme d'une quadrique à partir des ellipses de forme elliptiques. Cette quadrique a la propriété d'avoir sa projection perspective correspond à la forme de la spécularité pour une pose de caméra donnée.

Par la suite, dans le chapitre \ref{chapitre:dual_jolimas}, nous abordons l'extension du modèle de prédiction de spécularité JOLIMAS dans un contexte plus varié tel que les surfaces courbes et plus précisément les sources convexes. Nous avons fait le constat que les spécularités conservaient une forme elliptique sur les surfaces convexes. De plus, pour ces surfaces, une source de lumière ne produit également qu'une seule spécularité. Cependant, le comportement de ces spécularités sur ces surfaces mettent en échec le modèle JOLIMAS initial que nous appelons primal car la forme et la position de la spécularité sont grandement affectées par la courbure de la surface. En étudiant la géométrie épipolaire du système, nous observons que l'objet observée (source de lumière) est en mouvement dans le formalisme utilisé par notre modèle JOLIMAS primal alors que cette source de lumière est fixe. De ce fait, il n'est pas possible dans l'état de reconstruire une quadrique tel que la projection perspective corresponde au contour de la spécularité pour un nouveau point de vue. Dans JOLIMAS primal, adapté aux surface planes, nous utilisions les caméras réelles afin de reconstruire la quadrique utilisée pour la prédire la forme de la spécularité. Nous avons constaté que cette quadrique est localisée à l'emplacement du symétrique près de la source de lumière. Ce raisonnement est contre-intuitif pour généraliser le modèle car la source de lumière est fixe dans l'espace. Il est plus intéressant d'utiliser une représentation de caméra virtuelle calculées à partir des poses de caméras réelles qui reconstruire la quadrique autour de la lumière fixe.
Pour répondre à ce problème nous introduisons les contributions suivantes :
\begin{itemize}
    \item Formalisme d'un JOLIMAS dual en considérant une représentation de caméra virtuelle.
    \item Reconstruction d'une quadrique 3D pour chaque surface convexe. Généralisation du modèle pour un maillage plus complexe en décomposant celui-ci en un ensemble de surface convexe.
    \item Prédiction de spécularité adaptée aux surfaces convexes.
    \item Une application de retexturing revisitée, plus réaliste et incluant une modélisation de la spécularité plus précise et réaliste.
\end{itemize}
Ce chapitre a fait l'objet d'une publication internationale : ISMAR \citeyearpar{morgand2017multiple}, d'une publication nationale ORASIS \citeyearpar{morgand2017modele} et d'un journal international TVCG \citeyearpar{morgand2017geometric} .

Dans le chapitre \ref{chapitre:modele_general}, nous itérons à nouveau sur le modèle JOLIMAS dans sa forme duale afin de le généraliser à toute surface courbe (convexe, concave et autres). Dans cette itération, nous avons étudié le lien entre modification de la courbure d'une surface et modification de la forme d'une spécularité. En effet, si une surface n'a pas une courbure constante (au sens de Gauss), JOLIMAS dual ne pourra pas prédire le changement affectée aux contours de la spécularité.
Pour répondre à ce problème nous introduisons les contributions suivantes :
\begin{itemize}
    \item Formalisation de la notion d'angle limite qui est une propriété des contours de spécularité pour une pose de caméra donnée et une position de lumière donnée qui reste constante pour tout changement de courbure.
    \item Reconstruction d'un modèle géométrique canonique invariant aux changements de courbure. Nous reconstruisons notre quadrique à partir des ellipses correspondantes aux contours de spécularités transformées afin de revenir à une surface planaire (JOLIMAS primal).
    \item Prédiction de spécularité en déformant la projection perspective de la quadrique afin de correspondre à la courbure de la scène.
\end{itemize}
Ce chapitre a fait l'objet d'une publication internationale : VRST \citeyearpar{morgand2017amultiple} et d'une soumission dans un journal international TVCG 2018.

Dans le chapitre \ref{chapitre:RA}, nous résumons l'ensemble des contributions actuelles et potentielles en RA de notre modèle de prédiction. Nous détaillons le pipeline complet de notre application de retexturing. Nous présentons également quelques résultats non publiés de changements synthétiques de rugosité et de source lumineuses.