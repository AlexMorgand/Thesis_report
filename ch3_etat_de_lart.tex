\defineHeaderForClassicalChapter
\chapter{État de l'art}
\label{chapitre:etat_de_lart}
\graphicspath{{images/Ch3/}}



\begin{chapeauChapitre}
	\fix{Afin de modéliser l'illumination d'une scène de façon rapide et précise, de nombreux domaines, comme le cinéma, le rendu réaliste généré par ordinateur (CGI) et la photographie, ont recours à l'utilisation de  \textit{light probe}. Ces objets correspondent à des boules métalliques qui permettent d'avoir une vue à presque 360° de la scène incluant les sources de lumières. En plaçant un light probe dans la scène où à côté d'un objet spécifique pour plus de précision, nous pouvons indiquer les conditions d'éclairage en calculant la direction des rayons de lumières incidents, ne utilisant la réflexion de la scène sur la boule métallique pour avoir des reflets cohérents lors de l'insertion d'objets miroir et réfléchissant. Pour un usage plus courant dans les applications de vision par ordinateur, il n'est pas toujours possible d'utiliser un  \textit{light probe}. Il est souhaitable, par soucis de simplicité pour l'utilisateur, de n'avoir recours qu'à un procédé de vision par ordinateur pour estimer l'illumination.}
	Comme évoqué en introduction, modéliser de façon rapide et précise les phénomènes lumineux comme les ombres et spécularités est un problème mal-posé et complexe. Dans nos travaux de thèse, nous nous sommes concentré essentiellement sur une tâche plus réduite mais également complexe: la prédiction de spécularité. Il est intéressant de considérer les spécularités comme des éléments à part entière du fait de leurs importance en vision par ordinateur. En apportant une modification importante de l'intensité dans l'image de nombreux algorithmes de vision par ordinateur peuvent être perturbées comme les méthodes de segmentation, de reconstruction ou encore de localisation de caméra. Cependant, ces spécularités fournissent également des informations pertinentes sur les sources de lumière, la géométrie et les matériaux de la scène. En vue de la nouveauté de notre étude sur le phénomène des spécularités et la possibilité de les prédire pour des nouveaux points de vue, l'état de l'art des méthodes dédié uniquement à la prédiction est peu étoffé. Dans ce chapitre, nous décrivons les deux approches de l'état de l'art pouvant réaliser de la prédiction de spécularité mais généralement inclue dans un processus de reconstruction d'illumination: l'illumination globale et l'estimation de source lumineuses (incluant l'illumination locale).% Nous allons également évoquer les méthodes réalisant de la reconstruction 3D d'objet à l'aide de miroir car une surface spéculaire a un comportement très proche de celui d'un miroir. Une analogie peut être réalisé entre les méthodes de reconstruction multi-vues (SfM) utilisant une surface miroir pour reconstruire un objet et une méthode potentielle de SfM reconstruisant la spécularité.
\end{chapeauChapitre}


% =============================================================================
\section{Prédiction de spécularité}
\label{sec:prediction_de_specularite}
% =============================================================================

La prédiction de spécularité reste un problème difficile. En effet, les spécularités représentent un phénomène photométrique complexe décrit par une taille, une position, une forme et une intensité associée. De plus, ces éléments sont fortement influencés par la caméra (sa pose et sa fonction de réponse), la scène comprenant sa géométrie et les matériaux associés (réflectance et rugosité) et les sources de lumière (position, forme, intensité, isotropie ou anisotropie). À notre connaissance, aucune méthode de l'état de l'art ne permet la prédiction explicite de spécularité. En effet, l'approche naturelle serait d'estimer un modèle physique de la scène avec les paramètres associés : matériaux (reflectance et rugosité) et lumières (forme, pose, intensité et atténuation). Contrairement à la localisation de caméra et à la reconstruction géométrique de la scène, l'estimation de ces paramètres est possible mais difficile en pratique.

La plupart des approches de prédiction de spéculaire modélisent explicitement les sources de lumières ou l'illumination de la scène afin de créer un rendu des spécularités par la suite. Ces méthodes sont divisées en deux catégories: le rendu par illumination globale et l'estimation des sources de lumière.

\subsection{Rendu en illumination globale}
Les méthodes dans cette catégories privilégient la qualité de rendu des applications en approchant une solution à l'équation de rendu comme expliqué à la sous-section \ref{sec:rendering_equation} comme les méthodes de \cite{immel1986radiosity, kajiya1986rendering}. Pour rappel, cette équation décrit la quantité de lumière émise à un point $\vect{P}$ pour une direction d'observation donnée et à partir d'une BRDF de la lumière incidente donnée. Ces approches, en général, ne calculent pas les attributs physiques des sources de lumière et des matériaux de la scène. Par exemple, \cite{jachnik2012realtime} reconstruisent un \textit{light field} 4D sur une surface spéculaire plane de petite dimension. En reconstruisant les composantes diffuses et spéculaires, cette méthode présente des résultats de rendu photo-réaliste convaincant pour des applications de réalité augmentée et en temps-réel par une implémentation GPU. Cependant, elle est incapable de prédire la composante spéculaire pour des points de vue inconnus de la phase d'initialisation. En effet, cette estimation de l'illumination globale ne permet pas de distinguer les sources primaires et secondaires ce qui est essentiel pour la prédiction de spécularité sur des points de vue inconnus. De plus, les sources de lumières à état changeant (allumées ou éteintes) ne peuvent pas être géré avec ce type de méthodes. Des approches plus récentes comme \cite{richter2016instant} ont étendu \cite{jachnik2012realtime} en rajoutant une segmentation de matériau accompagné d'une reconstruction géométrique réalisée avec un capteur RGB-D. Cette méthode partage cependant les mêmes limitations que \cite{jachnik2012realtime}. Une autre approche de \cite{meilland20133d} présentent également une méthode d'estimation d'illumination globale en reconstruisant les sources primaires en tant que sources ponctuelles. Ces sources de lumières sont observées directement à partir d'une caméra RGB-D. Malgré la qualité des résultats obtenus, la méthode manque de flexibilité. En effet, la méthode représente une source étendue  comme un néon par un ensemble de sources ponctuelles. Ainsi, cette méthode doit calculer l'intensité lumineuse des différentes sources ponctuelles alors qu'elles devraient être considérées comme une unique source lumineuse. De plus, aucune lumière dynamique  (qui peuvent s'allumer ou s'éteindre dans la séquence) ne peut être utilisée et les matériaux pour la prédiction de spécularité ne sont pas calculés. En conséquence, cette méthode ne peut pas prédire les spécularités pour des points de vue inconnus.

La tendance actuelle des méthode d'illumination globale et d'utiliser des méthodes d'apprentissage profond comme \cite{mandl2017learning} en donnant en entrée un objet 3D de géométrie et \fix{albédo} connus. Le réseau de neurones convolutif utilise les coefficients de la fonction d'harmoniques sphérique calculée afin de généraliser l'illumination de façon immédiate après apprentissage. Cette méthode fournit un résultat à partir d'une seule image mais nécessite une période d'apprentissage de 4 heures par pose et l'illumination apprise se limite à l'objet appris.

\fix{Parler d'encore 2 methodes + un peu plus de détails sur les méthodes de jacknik et meilland. schalmstieg (mario)}

En conséquence, les méthodes citées ci-dessus ne peuvent pas prédire les spécularités pour de nouveaux points de vue car elles dépendent souvent d'une phase d'initialisation/apprentissage méticuleuse requièrent beaucoup de puissance de calcul et beaucoup d'images. Ces méthodes ne nous semblent pas adapter à un contexte temps réel en réalité augmentée.

\begin{figure}
\centering
\subfigure[Light field]
{
    \includegraphics[width=0.3\linewidth]{jachnik.png}
}
\subfigure[Reconstruction avec capteur RGB-D]
{
    \includegraphics[width=0.3\linewidth]{meilland.png}
}
\subfigure[Apprentissage profond]
{
    \includegraphics[width=0.3\linewidth]{mandl.png}
}
\caption{Trois illustrations de méthodes d'illumination globale. Dans (a), la méthode de \cite{jachnik2012realtime} permet d'ajouter un objet en réalité augmentée (cube en brique) dans des conditions d'illuminations réalistes en reconstruisant un \textit{light field}. Dans (b), à l'aide d'une caméra RGB-D, une reconstruction de la géométrie de la scène et de l'illumination sous forme d'un \textit{light field}. Dans (c), à partir d'une image RGB et d'un processus d'apprentissage profond des harmoniques sphériques de l'objet, un rendu réaliste est réalisé sur la figurine. Cependant, ces trois méthodes sont limités à la zone d'initialisation/apprentissage et ne sont pas assez flexibles dans un environnement plus dynamiques (grands déplacements de caméra, lumières qui s'allument ou s'éteignent).}
\label{fig:global_illumination_sota}
\end{figure}

\subsection{Modèles d'illumination locale}
En parallèle, d'autres travaux ont été proposés pour la reconstruction d'une source primaire. Idéalement, chaque modèle physique de lumière doit être associé à une géométrie (position et forme), une couleur \cite{lindsay2014automatic} et une valeur d'intensité pour correspondre de façon réaliste à la scène. Bien qu'il existe de nombreux modèles de lumière en infographie, les modèles utilisés pour la vision par ordinateur se divisent généralement en deux catégories : sources de lumière directionnelles et sources de lumière ponctuelles.  Dans un contexte extérieur, une source directionnelle semble plus naturelle pour représenter l'illumination comme le soleil mais peut aussi être pertinente dans un contexte intérieur (lumières au plafond par exemple). Par exemple, \cite{lagger2006using} décrivent une méthode pour calculer des sources de lumière directionnelles à partir d'un objet mobile sur un point de vue fixe. Cette application est limitée car les spécularités sont fortement dépendantes du point de vue. Les sources lumineuses doivent être estimées pour chaque position. Ni la forme ou position de la source lumineuse ou le matériau de l'objet n'est pris en compte ce qui rend cette méthode incapable de prédire les spécularités. De plus, les sources étendues comme les néons ne peuvent pas être modélisées correctement par des sources de lumière ponctuelles ce qui peut limiter l'applicabilité de la méthode.

Des approches similaires comme \cite{boom2013point, buteau2015poster, einabadi2015discrete, kanbara2004real, wong2008recovering} souffrent des mêmes problèmes avec les mêmes limitations. Pour l'estimation de sources lumineuses ponctuelles, l'approche de \cite{boom2013point} estime une source de lumière primaire dans un contexte Lambertien et en utilisant une caméra RGB-D. À partir du terme diffus et par comparaison avec un rendu synthétique de la scène, une unique source ponctuelle est estimée. Cependant, cette méthode n'est pas adaptée pour des applications temps réel et pour une estimation d'une source étendue comme un néon. En calculant une seule source lumineuse sans sa forme et les matériaux des surfaces de la scène, aucune prédiction de spécularité ne peut être réalisée.

\fix{Images + trouver d'autres applications plz, citer peut être les area lights (travaux de siggraph de deux années successives, regarder l'état de l'art de mes CVPR il y avait beaucoup de choses}
\begin{figure}
\centering
\subfigure[]
{
    \includegraphics[width=0.45\linewidth]{area_light.PNG}
}
\subfigure[]
{
    \includegraphics[width=0.41\linewidth]{karsch.PNG}
}
\end{figure}

Afin de prédire les spécularité à partir d'une reconstruction paramétrique d'une source de lumière requiert de calculer de nombreux paramètres de lumière et matériau complexes et parfois ambigu. Par exemple, estimer conjointement la reflectance du matériau et l'intensité de la source de lumière est un problème mal posé (\fix{ref}). En pratique, une approche physique comme celles citées précédemment ne permet pas la prédiction d'un phénomène photométrique aussi complexe que la spécularité.
\begin{figure}
\label{fig:local_illumination_sota}
\end{figure}

\subsection{Modèles géométriques}

Considérer la spécularité comme un élément géométrique est une piste qui a été peu étudiée. Dans les travaux de \cite{blake1988geometry}, le lien entre courbure de la surface et mouvement de la spécularité a été étudié et montre des résultats intéressants sur la compréhension du comportement d'une spécularité de façon géométrique. Dans un contexte où les poses de caméra et la géométrie sont connues, le mouvement de la spécularité peut être prédit. Cependant, aucune information n'est donnée dans la littérature expliquant la transformation de la forme d'une spécularité due aux changements de courbures.

\fix{images pour tout ça}
Il est possible de considérer la source de lumière et plus particulière la spécularité comme étant un objet 3D dans l'espace au même titre que tout autre objet 3D dans la scène. En effet, une spécularité correspond au reflet d'une source de lumière réflechie par une surface spéculaire. Le comportement de ces surfaces est très proche de celui d'une surface mirroir. Ainsi, nous pouvons rapprocher ce type de méthode aux méthodes de SfM (Structure-from-Motion) faisant une reconstruction 3D à partir de réflexions miroir comme \cite{kuthirummal2007flexible, mitsumoto19923, savarese2005local}. En géométrie multi-vues, nous distinguons différents cas pour reconstruire un objet statique par projection perspective. Le cas le plus simple est celui d'un objet directement observé. Les points, lignes ou autres caractéristiques visuelles 3D sont obtenues dans l'image par simple projection perspective en fonction de la pose de la caméra. Dans le cas d'un objet, observé à travers un miroir parfait, les caractéristiques visuelles 3D sont obtenues dans l'image en calculant leur symétrique par rapport à la normale du miroir. Pour une source de lumière ponctuelle observée directement dans une image, l'intensité combinée à la sensibilité du capteur font que l'image de la source de lumière ne correspond pas exactement à la projection des caractéristiques visuelles 3D d'une source de lumière. En effet, il est très difficile d'observer une source de lumière de façon consistante et précise car cette source de lumière augmente fortement l'intensité générale de l'image. En présence d'une surface spéculaire, en complément de l'intensité de la source de lumière et de la sensibilité du capteur, l'image du source de lumière ponctuelle est observée à travers une la surface brillante (de comportement proche de celui d'un miroir) est affectée par le matériau de la surface (reflectance et rugosité). Ainsi, cette image ne correspond pas exactement à la projection perspective des caractéristiques visuelles 3D. Cette image est appelée spécularité. Ce décalage entre la forme réelle et observée semble être représentée par un changement d'échelle de la source de lumière. Dans ce mémoire, nous aborderons particulièrement ce problème de modélisation de spécularité par une forme 3D, comment appliquer cette modélisation dans un processus de prédiction de spécularité et qu'elles sont les avantages d'un tel type de modèle par rapport aux autres approches de l'état de l'art.


% =============================================================================
\section{Positionnement}
\label{sec:positionnement}
% =============================================================================

Afin d'adresser ce problème complexe et fortement non-linéaire, nous proposons un modèle virtuel empirique basé sur la reconstruction d'une quadrique à partir de coniques calculées sur les spécularités dans chaque point de vue. Malgré sa simplicité, ce modèle empirique abstrait les paramètres des matériaux et sources lumineuses permettant la prédiction de spécularité pour des points de vue inconnus en présence d'une ou plusieurs sources de lumière. Dans le chapitre suivant \ref{chapitre:primal_jolimas}, nous présentons notre modèle géométrique appelé \textit{JOint LIght-MAterial Specularity} (JOLIMAS) permettant d'abstraire l'interaction lumière/matériau. Ce modèle est né de l'observation de la forme des spécularité sur des surfaces planaires. Sur ces surfaces, ces éléments présentent une forme elliptique. Ce constat n'a, à notre connaissance, jamais été explicité et démontré dans l'état de l'art. Les chapitres suivants \ref{chapitre:dual_jolimas} et \ref{chapitre:modele_general} traiterons de la généralisation de ce modèle pour des surfaces plus complexes (courbes, concaves, convexes). Notre modèle en plus de prédire la position des spécularités pour chaque source de lumière et chaque surface de la scène peut être utilisée pour diverses applications notamment la réalité augmentée. Dans le chapitre \ref{chapitre:RA}, nous développerons les diverses applications développées soulignant l'efficacité et la pertinence de notre modèle.