\chapter{Un modèle dual pour les surfaces convexes à courbure constante}
\label{chapitre:dual_jolimas}
\defineHeaderForClassicalChapter
\graphicspath{{images/Ch4/}}

\begin{chapeauChapitre}
Prédire les spécularités dans une image, à partir d'une pose de caméra et de la géométrie de la scène connues, est un problème complexe et ouvert. Cette prédiction est néanmoins essentielle pour de nombreuses applications en réalité augmentée. L'approche JOLIMAS, présentée au chapitre \ref{chapitre:primal_jolimas}, répond partiellement à ce problème sous l'hypothèse que les spécularités ont une forme elliptique et que la scène est composée d'un objet plan. JOLIMAS modélise une spécularité comme étant l'image d'une quadrique fixe dans l'espace. Dans ce chapitre, nous présentons JOLIMAS dual, un modèle géométrique qui répond à la limitation aux plans. Ce modèle repose sur le fait que les spécularités conservent leurs formes elliptiques sur des surfaces convexes et que chaque surface peut être divisée en plusieurs parties convexes. La géométrie de JOLIMAS dual utilise une quadrique pour chaque surface convexe et chaque source lumineuse et prédit les spécularités en utilisant des caméras virtuelles permettant de gérer la courbure de la surface. Nous évaluons l'efficacité et la précision du JOLIMAS dual sur de multiples séquences synthétiques et réelles composées de divers types d'objets et sous différents éclairages.
\end{chapeauChapitre}

% =============================================================================
\section{Introduction} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:intro_dual}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================

Le SLAM (\textit{Simultaneous Localization And Mapping}) a récemment gagné en maturité. Son intégration dans l'industrie a fortement augmenté avec l'aide notamment de nombreuses méthodes de localisation de caméra disponibles publiquement telles que \cite{engel2016direct, tan2013robust} et de reconstruction 3D telle que \cite{newcombe2011kinectfusion, whelan2015elasticfusion}. La plupart des approches SLAM considèrent que la scène observée est Lambertienne (surface mate), une condition qui n'est pas vérifiée dans une scène contenant des objets à matériaux spéculaires tels que du métal, du plastique ou de la porcelaine. En raisons d'une interaction proche de celle d'un miroir entre les sources de lumière et les matériaux spéculaires, des spécularités apparaissent et provoquent des changements brusques d'intensité dans l'image. \cite{blake1988geometry} montrent que les spécularités sont des éléments utilisés pour la perception humaine d'une scène pour percevoir la géométrie et le type de matériau d'un objet. En vision par ordinateur, les spécularités jouent un rôle important et font l'objet de nombreuses études \cite{artusi2011survey, delpozo2007detecting, kim2013specular, klinker1990physical}. Elles sont, en général, considérées comme indésirables mais peuvent être utilisées comme des traces visuelles intéressantes. D'un côté, elles peuvent être utilisées pour améliorer la localisation de la caméra \cite{chang20093d, lagger20083d, netz2013recognitionpami} ou encore un processus de reconstruction 3D \cite{whelan2016elasticfusion}. D'un autre côté, elles peuvent grandement améliorer la qualité de rendu des applications de réalité augmentée et diminuée \cite{zhang2016emptying, said2017image}. Ainsi, il subsiste un besoin de prédiction de spécularités dans plusieurs applications. 
%Le problème de prédiction de spécularité est difficile, même dans un contexte où la pose de caméra et la géométrie de la scène sont connues. La formation de ces éléments est dépendante de plusieurs éléments physiques de la scène comme la surface, les matériaux, les sources de lumière et la caméra. En connaissant ces deux éléments, l'apparence visuelle de la spécularité peut dans certains cas être expliquée concrètement par l'intensité de la lumière et les propriétés des matériaux (reflectance, rugosité). Cette ambiguïté rend le problème de prédiction de spécularité particulièrement complexe.

%Les méthodes existantes de prédiction de spécularité \cite{jachnik2012realtime, boom2013point, richter2016instant} n'exprime pas les spécularités de manière explicite mais les inclues dans un processus de modélisation de la lumière en utilisant des modèles d'illuminations issus de l'infographie. Elles supposent une illumination distante et requièrent le calcul de nombreux paramètres sur les matériaux, les sources de lumière et ne fournissent pas une solution géométrique flexible pour prédire les spécularités pour de nouveaux points de vue. Ces méthodes sont classées dans deux catégories: illumination globale et reconstruction de source de lumière. Une troisième catégorie d'approches existe où le problème de prédiction de spécularité est considéré comme un problème de reconstruction multi-vues.
Dans le chapitre précédent \ref{chapitre:primal_jolimas}, nous avons montré qu'une spécularité sur une surface plane peut être convenablement approchée par une ellipse sous un éclairage provenant d'une ampoule ou d'un néon. Nous avons présenté notre modèle empirique appelé \textit{JOint LIght-MAterial Specularity} (JOLIMAS) pour abstraire l'interaction lumière-matière et traiter le problème de prédiction de spécularité géométriquement. Ce modèle utilise une quadrique fixe dont la projection prédit la forme des spécularités sur des points de vue existants et nouveaux. La reconstruction de quadrique est obtenue avec au moins trois points de vue. Nous nous référerons à ce modèle comme étant {\em JOLIMAS primal}.


%=============================================================================
\section{Approche proposée} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:approche_proposee_dual}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================

\fix{Nous proposons un nouveau modèle, {\em JOLIMAS dual},  qui est une généralisation du primal aux surfaces convexes par morceaux tout en conservant sa fonctionnalité sur des surfaces planes. L'idée principale est que les spécularités conservent leur forme elliptique sur des surfaces convexes. Notre modèle se base sur une représentation  virtuelle des caméras qui associe une caméra virtuelle à chaque spécularité avec la pose de la caméra réelle et la géométrie de la surface connues. Du fait que chaque surface peut être divisée en parties convexes, nous pouvons modéliser et prédire les spécularités sur des objets plus complexes comme illustré à la figure \ref{fig:teaser}. En pratique, nous représentons une surface par un maillage et utilisons un procédé de décomposition convexe approximative comme expliqué dans la section \ref{sec:jolimas_piecewise}. Nous reconstruisons une quadrique pour chaque partie convexe et chaque source de lumière. Nous expliquons le détail de notre modèle de prédiction de spécularité et le calcul de notre représentation pour de nouveaux points de vue.% dans la section \ref{sec:prediction}.
 Cette prédiction n'est pas triviale car les caméras virtuelles utilisées pour la prédiction requièrent le calcul du point d'intensité maximale d'une spécularité inconnue pour un nouveau point de vue. Nous détaillerons le calcul de ce point particulier par utilisation de notre quadrique reconstruite. L'efficacité et la précision de notre méthode sont validée par de nombreux exemples synthétiques et réels incluant divers types d'objets et diverses conditions lumineuses dans la section  \ref{sec:experimental_results}}.

\fix{Notre modèle étend notre approche précédente présentée dans le chapitre \ref{chapitre:primal_jolimas}  aux surfaces non-planes tout en reprenant l'approximation de spécularités de forme elliptique même pour des sources étendues. Nous proposons JOLIMAS dual qui utilise des caméras virtuelles obtenues par symétrie des caméras réelles selon le plan tangent à un point particulier de la surface à l'opposé de JOLIMAS primal, qui utilise des caméras réelles. Notre approche améliore la reconstruction en termes de généricité avec un nombre de points de vue nécessaires inférieur à la version primale grâce à une meilleure répartition des caméras virtuelles. De nouvelles caméras virtuelles peuvent être ajoutées par l'utilisation de spécularités sur des objets similaires (courbure et matériaux) à partir de la même source de lumière.}

\section{JOLIMAS dual}
\label{sec:dual_jolimas}

\subsection{Notation et formalisation}
Une scène 3D typique contient une caméra de pose $\mathtt{\Pi} = \begin{bmatrix} \mathtt{R} & \mbf{V} \end{bmatrix}$ et une source de lumière $\mbf{L}$. Un point de surface est noté $\mbf{P}$ et de normale $\hat{\mbf{N}}(\mbf{P})$. Nous utilisons $\hat{\mbf{L}}$ en tant que vecteur normalisé désignant le rayon de lumière incident de la source de lumière $\mbf{L}$ tel que $\hat{\mbf{L}}(\mbf{P}) = \mu(\mbf{L} - \mbf{P})$ et $\hat{\mbf{V}}$ le vecteur normalisé désignant la caméra $\mbf{V}$ tel que $\hat{\mbf{V}}(\mbf{P}) = \mu(\mbf{V} - \mbf{P})$. Le plan tangent $\mbf{P}$ est défini par \mbox{$\pi_\mbf{P} = \begin{bmatrix}\hat{\mbf{N}}(\mbf{P}) \\ -d\end{bmatrix}$} avec $d$ la distance du plan à l'origine. Chaque entité virtuelle calculée par symétrie est notée avec \textasciitilde \text{ }, tel que la position de la caméra virtuelle est notée $\tilde{\mbf{V}}$ et la pose virtuelle $\tilde{\Pi}$.

\subsection{Similarité du comportement d'une surface spéculaire avec un miroir}
Pour une surface plane, nous pouvons interpréter une spécularité comme étant une image miroir de la source de lumière. Cependant, pour des surfaces courbes, cette image miroir est distordue et incohérente avec la vraie position et forme de la source de lumière. A partir des spécularités, nous ne pouvons pas reconstruire un objet 3D cohérent localisé autour de la source de lumière dans l'état. L'idée principale de JOLIMAS dual est d'utiliser des caméras virtuelles pour reconstruire la quadrique de façon cohérente avec la source de lumière. Ces caméras virtuelles sont calculées par symétrie de la vraie caméra avec la surface. Contrairement aux surfaces planes, la normale varie le long de la surface courbe, ce qui rend le choix de la caméra virtuelle ambigu. Pour une pose de caméra et une spécularité données, quel point de la surface devons-nous choisir pour calculer cette caméra virtuelle ?

\subsection{Le point d'intensité maximale}
Sur des surfaces convexes, plusieurs propriétés peuvent être mise en évidence. Premièrement, une spécularité conserve une forme elliptique de la même manière que sur les surfaces planes comme illustré à la figure \ref{fig:conic_shape}. Deuxièmement, une source de lumière est associée à une unique spécularité. Enfin, si nous transformions une surface plane en une surface convexe, la forme de la spécularité ne serait affectée que par son échelle.
\begin{figure}[!ht]
\centering
    \subfigure[]
    {
        \includegraphics[width=0.45\linewidth]{ball.png}
    }
    \subfigure[]
    {
        \includegraphics[width=0.45\linewidth]{water_heat.png}
    }

\caption{Spécularités sur des surfaces convexes tel qu'une balle en mousse (a) et un ballon d'eau chaude (b). L'hypothèse de spécularités elliptiques est toujours valide pour ces surfaces comme le montre les ellipses sur les gros plans (a) et (b). Pour chaque surface convexe, il y a une source de lumière pour chaque spécularité (une source de lumière dans (a) et deux sources de lumières dans (b)).}
\label{fig:conic_shape}
\end{figure}
Plusieurs études comme celles du chapitre \ref{chapitre:primal_jolimas} et \cite{kim2013specular, tian2013real} ont souligné l'importance d'un point spécifique appelé le point d'intensité maximale qui est unique pour chaque spécularité pour des surfaces planes mais aussi convexes (voir annexe \ref{annexe:analysis_phong_blinn}). Pour chaque direction autour de ce point, l'intensité de la spécularité décroit. Ce point est très important en optique car pour une pose de caméra et une position de source lumineuse données, il suit la loi de la réflexion:
\begin{equation}
\hat{\mbf{L}}(\mbf{P}) = 2(\hat{\mbf{N}}(\mbf{P})^\top \hat{\mbf{V}}(\mbf{P}))\hat{\mbf{N}}(\mbf{P}) - \hat{\mbf{V}}(\mbf{P}).
\label{eq:snell_descartes}
\end{equation}
Ceci implique que le point d'intensité maximale n'est pas affecté par la distorsion induite par la courbure de la surface. Si nous calculons le symétrique de la caméra par rapport au plan tangent à ce point, nous obtenons une caméra virtuelle qui pointe directement à la source de lumière en passant à l'intérieur de la spécularité comme illustré à la figure \ref{fig:snell_general}. En calculant la caméra virtuelle pour chaque spécularité, nous pouvons ainsi reconstruire une quadrique localisée à une position proche de la source de lumière et dont la projection correspond à la forme des spécularités.
\begin{figure}[!ht]
\centering
    \subfigure[]
    {
        \includegraphics[width=0.47\linewidth]{snell_sphere.pdf}
    }
    \subfigure[]
    {
	  \label{fig:main_schema}
	  \includegraphics[width=0.47\linewidth]{main_schema.pdf}
    }
    \subfigure[]
    {
	  \includegraphics[width=\linewidth]{epipolar_dual.pdf}
    }

\caption{JOLIMAS dual utilise des caméras virtuelles produisant des ellipses épipolairement consistantes. Dans (a), nous montrons la loi de la réflexion sur une surface convexe. Le point le plus intense $\mbf{P_B}$ correspond au point de la surface où l'intersection de la ligne contenant la position de la caméra virtuelle $\tilde{\mbf{V}}$ (en vert) et la source de lumière $\mbf{L}$ est confondue avec le point de la surface utilisé pour calculer la caméra virtuelle. Dans (b), nous présentons JOLIMAS dual sur une surface convexe pour 3 poses de caméra données $\Pi_1$, $\Pi_2$ et $\Pi_3$. Les poses de caméra (en vert) $\tilde{\Pi}_{1}$, $\tilde{\Pi}_{2}$ et $\tilde{\Pi}_{3}$ permettent de reconstruire une quadrique proche de la source de lumière réelle $\mbf{L}$. Dans (c), nous montrons que notre représentation virtuelle de caméra permet d'obtenir des ellipses respectant la géométrie épipolaire.
}
\label{fig:snell_general}
\end{figure}
Dans l'annexe \ref{annexe:analysis_phong_blinn}, nous démontrons que le point d'intensité maximale du modèle d'illumination de Phong est unique et localisé à l'intersection de la ligne contenant la position de la source de lumière $\mbf{L}$ et le symétrique de la position de la caméra $\tilde{\mbf{V}}$ dans le cas de surfaces planaires. Pour des surfaces convexes, cette propriété est conservée si le point de la surface utilisé pour calculer $\tilde{\mbf{V}}$ coïncide avec le point d'intersection comme illustré à la figure \ref{fig:snell_general}.

Notons qu'en pratique, le calcul du point le plus intense se doit d'être le plus précis possible car les caméras virtuelles sont sensibles aux erreurs de normale. Nous présentons une méthode d'estimation de ce point  d'intensité maximale à partir d'aprioris géométriques sur le maillage dans la section \ref{sec:bp_computation}.


%=============================================================================
\section{Représentation par caméras virtuelles} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:representation_par_cameras virtuelles}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================
Nous calculons JOLIMAS dual à partir de la caméra virtuelle estimée à partir du point le plus intense pour chaque image sur la surface. Nous utilisons une estimation initiale du point du plus intense $\mbf{P_B}$, à partir d'une détection de spécularité initiale, en prenant le centre de gravité des contours de la spécularité. En pratique, ce point le plus intense n'est pas unique dans l'image car la spécularité provoque souvent une saturation de l'image. Une pose de caméra virtuelle $\tilde{\mathtt{\Pi}}$ est calculée en suivant le formalisme de \cite{long2015simplified} sur une pose de caméra réelle $\mathtt{\Pi}$ telle que:
\begin{equation}
\tilde{\mathtt{\Pi}} = \mathtt{\Pi}\mathtt{S} \text{ avec } \mathtt{S} = 
\begin{bmatrix}
\mathtt{I_3} - 2\hat{\mbf{N}}(\mbf{P})\hat{\mbf{N}}(\mbf{P})^\top & \mbf{0} \\
-2d\hat{\mbf{N}}(\mbf{P}) & 1
\end{bmatrix}^\top.
\label{eq:virtual_camera}
\end{equation}
Pour une source de lumière unique, le pipeline de l'estimation de notre modèle est:
\begin{itemize}
\item Détection de spécularité calculant simultanément le point le plus intense pour chaque spécularité.
\item Estimation des caméras virtuelles initiales par symétrie des caméras réelles avec la surface pour chaque point d'intensité maximale.
\item Correction épipolaire à partir de \cite{reyes2005projective} et reconstruction de la quadrique à partir de \cite{cross1998quadric} pour au moins 3 points de vue.
\item Correction des points d'intensité maximale de chaque spécularité à partir de la reconstruction de quadrique (décrite dans \ref{sec:bp_computation}).
\item Raffinement non-linéaire à partir de tous les points de vue disponibles.
\end{itemize}
Un exemple de notre représentation de caméra virtuelle est présenté à la figure  \ref{fig:main_schema}. Ce pipeline est répété pour chaque source de lumière.
Un récapitulatif du pipeline est illustré à la figure \ref{fig:pipeline}.
\begin{figure}[!ht]
    \centering
    \includegraphics[width=0.7\linewidth]{pipeline.pdf}
\caption{Pipeline de notre méthode décrivant les données d'entrée, le calcul de notre modèle dual JOLIMAS et le processus de prédiction de spécularité. Notre méthode produit une ellipse descrivant la forme et la position de la spécularité dans l'image. Cette représentation géométrique abstrait l'interaction de la source de lumière (intensité, position, forme, couleur) avec  le matériau (reflectance et rugosité) de la surface.}
    \label{fig:pipeline}
\end{figure}

%=============================================================================
\section{Triangulation de la position de source lumineuse} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:triangulation}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================

\subsection{Estimation initiale}
A partir d'un minimum de deux points d'intensité maximale  $\mbf{P_{B,1}}$ et $\mbf{P_{B,2}}$ provenant de deux spécularités (dans une même image où une paire d'images clés), il est possible de trianguler la position de source de lumière $\mbf{L}$. A ces deux spécularités, nous associons deux poses de caméra virtuelles $\tilde{\mat{\Pi}}_1 = \begin{bmatrix} \mathtt{R_1} & \mbf{V_1} \end{bmatrix}$ et $\tilde{\mat{\Pi}}_2 = \begin{bmatrix} \mathtt{R_2} & \mbf{V_2} \end{bmatrix}$. Les vecteurs $\vect{d_1}$ et $\vect{d_2}$ représentent les directions des rayons partant des centres optiques des caméras virtuelles par les points d'intensité maximale dans les images. On a alors:
\begin{equation}
\vect{d_1} = \frac{\mat{R_1}\mat{K}^{-1}\mbf{P_{B,1}}}{\| \mat{R_1}\mat{K}^{-1}\mbf{P_{B,1}} \|} \text{ et } \vect{d_2} = \frac{\mat{R_2}\mat{K}^{-1}\mbf{P_{B,2}}}{\| \mat{R_2}\mat{K}^{-1}\mbf{P_{B,2}} \|},
\end{equation}
et les deux rayons optiques peuvent être paramétrés de la façon suivante :
\begin{equation}
\vect{r_1}(\lambda) = \vect{V_1} + \lambda \vect{d_1} \text{ et } \vect{r_2}(\mu) = \vect{V_2} + \mu \vect{d_2}.
\end{equation}
Les deux rayons ne sont probablement pas sécants ni parallèles, et il existe une droite $(\vect{H_1}\vect{H_2})$ qui leur est orthogonale, $\vect{H_1} \in \vect{r_1}$  et $\vect{H_2} \in \vect{r_2}$. On cherche le point $\vect{P}$ au milieu du segment $[\vect{H_1}\vect{H_2}]$ et on commence par déterminer les valeurs de $\lambda$ et $\mu$ telles que :
\begin{equation}
\vect{H_1} = \vect{V_1} + \lambda \vect{d_1} \text{ et } \vect{H_2} = \vect{V_2} + \mu \vect{d_2}.
\end{equation}
Le vecteur $\vect{w} = \vect{d_1} \times \vect{d_2}$ est le support de la droite $(\vect{H_1}\vect{H_2})$. On a donc :
\begin{equation}
\vect{w} // (\vect{H_1}\vect{H_2}) \text{ soit } \vect{d_1} \times \vect{d_2} // \vect{V_2} - \vect{V_1} + \mu \vect{d_2} - \lambda \vect{d_1},
\end{equation}
ce qui est équivalent à :
\begin{equation}
\left\{
    \begin{array}{ll}
        \vect{d_1} \cdot (\vect{V_2} - \vect{V_1} + \mu \vect{d_2} - \lambda \vect{d_1}) = 0 \\
        \vect{d_2} \cdot  (\vect{V_2} - \vect{V_1} + \mu \vect{d_2} - \lambda \vect{d_1}) = 0
    \end{array}
\right.
\end{equation}
Cela  permet de déterminer $\lambda$ et $\mu$ avec $\vect{d_1}$ et $\vect{d_2}$ normés:
\begin{equation}
\begin{aligned}
\lambda = \frac{(\vect{V}_2 - \vect{V}_1)\cdot \vect{d_1} - (\vect{d_1} \cdot \vect{d_2})(\vect{V}_2 - \vect{V}_1)\cdot \vect{d_2}}{1 - (\vect{d_1} \cdot \vect{d_2})^2} \\
\mu = \frac{(\vect{d_1} \cdot \vect{d_2})(\vect{V}_2 - \vect{V}_1) \cdot \vect{d_1} - (\vect{V}_2 - \vect{V}_1) \cdot \vect{d_2}}{1 - (\vect{d_1} \cdot \vect{d_2})^2}
\end{aligned}
\end{equation}
Le point $\vect{P}$ est reconstruit au milieu de $[\vect{H_1}\vect{H_2}]$ tel que :
 \begin{equation} 
	\mbf{P} = \frac{1}{2}[(\mbf{t}^0 + \lambda\mbf{d}^0) + (\mbf{t}^1 + \mu\mbf{d}^1)].
\end{equation}
Cette reconstruction de la position de la source de lumière $\vect{L}$ peut être réalisée à partir d'au moins trois observations en prenant les différentes paires de caméras virtuelles et en faisant la moyenne des points triangulés obtenus par chaque paire. En pratique, $\mbf{P_{B,1}}$ et $\mbf{P_{B,2}}$ sont initialisés en prenant le centre de gravité de la zone d'intensité maximale (lorsque le point d'intensité maximale n'est pas unique) de la spécularité associée.


\subsection{Raffinement de la position de la lumière et du point d'intensité maximale}
\label{sec:bp_computation}
Selon l'équation \eqref{eq:snell_descartes}, un point $\mbf{P}$ de la surface est considéré comme étant le point d'intensité maximale si $\mu(\tilde{\mbf{V}} - \mbf{P})$ et $\mu(\mbf{L} - \mbf{P})$ sont colinéaires. Cela signifie que le point de la surface $\mbf{P}$ utilisé pour calculer la caméra virtuelle doit être identique à l'intersection de la ligne contenant la caméra virtuelle  $\tilde{\mbf{V}}$ et la source de lumière $\mbf{L}$ avec le plan tangent  $\pi_\mbf{P}$ d'une surface $S$ au point $\mbf{P}$. Cette propriété est illustrée à la figure \ref{fig:bp_computation}. Ce point d'intersection $\mbf{P}_I$ est défini par :
\begin{equation}
\mbf{P}_I = \tilde{\mbf{V}} + \frac{\tilde{\mbf{V}}^\top\hat{\mbf{N}}({\mbf{P}}) - d}{(\mbf{L} - \tilde{\mbf{V}})^\top\hat{\mbf{N}}(\mbf{P})}(\mbf{L} - \tilde{\mbf{V}})
\end{equation} 
avec
$$
    \tilde{\mbf{V}} = \begin{bmatrix}
\mathtt{I_3} - 2\hat{\mbf{N}}(\mbf{P})\hat{\mbf{N}}(\mbf{P})^\top & -2d\hat{\mbf{N}}(\mbf{P})
\end{bmatrix} \begin{bmatrix}
\mbf{V} \\
1
\end{bmatrix}.
$$
Le calcul du point le plus intense doit être réalisé pour chaque surface convexe et chaque source de lumière. Notre estimation du point d'intensité maximale est décrite dans l'algorithme \ref{algo:bp}.
\begin{algorithm}
\caption{Version simplifiée du calcul du point d'intensité maximale à partir d'une pose de caméra, le modèle CAO et la position de la source de lumière obtenue par triangulation la première fois puis en prenant le centre de la quadrique par la suite.}
\begin{algorithmic}[1]
\Procedure{CalculPointIntensitéMax}{\textit{Pose, Modèle, L}}
\State $\textit{BP} \gets \textit{initial\_BP}$
\Do
\State $VirtualPose \gets \textit{compute\_virtual\_pose(Pose, BP)}$
\State $\textit{P} \gets model\_intersection(L, VirtualPose, Model)$
\State $\textit{search\_direction} \gets \frac{\textit{P} - \textit{BP}}{\| \textit{P} - \textit{BP} \|}$   
\State $\textit{BP} \gets \textit{BP} + \textit{search\_direction}$
\doWhile{$\textit{BP} \neq \textit{P}$} \\
\Return $BP$
\EndProcedure
\end{algorithmic}
\label{algo:bp}
\end{algorithm}

\subsection{Interpolation de normale}
Afin de calculer des caméras virtuelles cohérentes, une information de normale de surface précise est importante. Sur un maillage, cette information est fournie uniquement par les arêtes et les faces du modèle CAO. Afin de trouver le point d'intensité maximale le plus juste, nous devons retrouver la variation de normale précisément sur les différents polygones du maillage, Pour répondre à ce problème, nous utilisons une interpolation de normale entre les différents polygones du maillage ce qui est une approche similaire à l'interpolation de normale utilisée par \cite{phong1975illumination}.
Nous commençons à partir d'un point $\mbf{P}$ de normale inconnue $\hat{\mbf{N}}(\mbf{P})$ sur un polygone du maillage. Après avoir calculé les normales $\hat{\mbf{N}}_i$ pour chaque sommet $i$ du triangle, nous traçons une ligne incluant $\mbf{P}$ dans une direction donnée (l'axe $\mbf{y}$ par exemple) qui intersecte plusieurs arêtes du polygone. Pour ces points d'intersection, nous calculons leurs normales par interpolation linéaire. La normale finale $\hat{\mbf{N}}(\mbf{P})$ est calculée à partir de l'interpolation linéaire des normales des points d'intersection le long de la ligne, comme illustré à la figure \ref{fig:normal_interpolation}.

\begin{figure}[!ht]
	\subfigure[]
	{
	    \includegraphics[width=0.45\linewidth]{bp_computation}
	    \label{fig:bp_computation}
	}
	\subfigure[]
	{
	    \includegraphics[width=0.45\linewidth]{normal_interpolation}
	    \label{fig:normal_interpolation}
	}
\caption{Calcul du point le plus intense et interpolation de normale. Dans (a), notre algorithme pour calculer le point le plus intense est illustré. A partir d'une initialisation $\mbf{P}_1$, nous calculons la position de la caméra virtuelle $\tilde{\mbf{V}}_1$ (symétrique de $\mbf{V}$) par rapport au plan tangent à la surface en $\mbf{P}_1$ et la ligne contenant $\tilde{\mbf{V}}_1$ et $\mbf{L}$. Puisque l'intersection $\mbf{P}_{I, 1}$ entre la ligne et la surface $S$ n'est pas égale à $\mbf{P}_1$, nous itérons à la face adjacente dans la direction du point d'intersection. Ce procédé s'arrête quand la distance entre $\mbf{P}$ et $\mbf{P}_{I}$ est minimale. Pour améliorer l'estimation sur la face restante, nous calculons une normale plus précise en utilisant une interpolation de normale dans (b). Dans cet exemple, à partir d'un polygone comportant trois sommets avec normales associées, la normale $\hat{\mbf{N}}(\mbf{P})$ en $\mbf{P}$ est calculée en interpolant les normales sur la ligne horizontale contenant $\mbf{P}$ avec les arrêtes du polygone donnant $\hat{\mbf{N}}_{12}$ et $\hat{\mbf{N}}_{23}$. A partir d'une interpolation linéaire de ces deux normales,  $\hat{\mbf{N}}(\mbf{P})$  est calculé.}
\label{fig:bp_computation_full}
\end{figure}

%=============================================================================
\section{Surfaces convexes par morceaux} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:jolimas_piecewise}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================
\subsection{Principe}
Pour chaque source de lumière, nous avons un unique point d'intensité maximale et plus généralement une spécularité unique pour chaque surface convexe. Cette hypothèse est semblable au comportement d'un miroir de forme convexe. Dans ce miroir, la réflexion d'un objet donné sera distordue mais l'image de celui-ci sera unique. Nous pouvons représenter un modèle 3D d'un objet comme étant la combinaison de surfaces convexes. En pratique, nous reconstruisons une quadrique pour chaque surface convexe et chaque source de lumière.

\subsection{Décomposition d'un modèle CAO en surfaces convexes approximatives}
Selon \cite{lien2007approximate}, chaque maillage 3D peut être approximé par la combinaison de plusieurs surfaces convexes. La décomposition convexe approximative est souvent utilisée dans les moteurs physiques pour accélérer la détection de collisions. Notre objectif est de déterminer une décomposition convexe d'une surface $S$, qui consiste à la partitionner en un ensemble minimal de sous-surfaces convexes. Ce procédé a pour but de déterminer la partition des triangles du maillage avec un nombre d'amas minimal tout en assurant que chaque amas a une concavité plus petite qu'un seuil prédéfini. Une décomposition convexe exacte est un problème {\em NP-complet} et ne serait pas utilisable du fait d'une fragmentation trop importante des amas. Nous utilisons ainsi une bibliothèque de décomposition convexe approximative appelée V-HACD\footnote{\url{github.com/kmammou/v-hacd}} pour segmenter notre maillage en plusieurs surfaces convexes. En utilisant cette décomposition, notre modèle peut être généralisé aux objets non-plans en reconstruisant une quadrique pour chaque surface convexe. Nous illustrons cette décomposition sur la figure \ref{fig:acd2} et \ref{fig:acd}. Notre maillage est reconstruit à partir du scanner HandySCAN 3D de l'entreprise Creaform\footnote{\url{www.creaform3d.com/en}} comme illustré aux figures \ref{fig:scanner} et \ref{fig:scanned}.

\begin{figure}[!ht]
   \centering
      \subfigure[]
	  {
	      \includegraphics[width=0.46\linewidth]{scanner.png}
	      \label{fig:scanner}
	  }	
      \subfigure[]
	  {
	      \includegraphics[width=0.46\linewidth]{scanned.png}
	      \label{fig:scanned}
	  }	
      \subfigure[]
	  {
	      \includegraphics[width=0.46\linewidth]{acd2.png}
	      \label{fig:acd2}
	  }      
      \subfigure[]
	  {
	      \includegraphics[width=0.46\linewidth]{acd.png}
	      \label{fig:acd}
	  }   
	  \caption{Scan d'un objet et sa décomposition convexe approximative. Dans (a), nous utilisons le capteur HandySCAN 3D sur un vase et nous montrons la reconstruction du maillage en (b). Pour deux maillages scannés à partir d'objets réels présentés dans la figure \ref{fig:teaser}, nous montrons  les résultats de l'algorithme de décomposition convexe approximative. Dans (a) le maillage de la réplique de fusée est décomposé en 7 surfaces convexes, ainsi que le vase jaune. Nous avons une spécularité par surface convexe et par source de lumière et nous reconstruisons une quadrique virtuelle à chaque fois.}
	  \label{fig:acd_full}
\end{figure}

%
%%=============================================================================
%\section{Prédiction de spécularité} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\label{sec:prediction_de_specularite}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% =============================================================================
%\label{sec:prediction}
%\subsection{Principe}
%\fix{c'est pas censé être là. A bouger ou virer.}
%La prédiction de spécularité est obtenue dans JOLIMAS primal en projetant la quadrique résultante pour de nouveaux points de vue avec une pose donnée donnant une ellipse correspond à la nouvelle spécularité. Cependant, dans JOLIMAS dual, pour de nouveaux points de vue, la position du point d'intensité maximale est requise pour calculer la caméra virtuelle. Cette caméra virtuelle sera utilisée par la suite pour projeter la quadrique reconstruite de façon adéquate. Pour l'initialisation, nous utilisons une approximation du point d'intensité maximale en partant du centre de la quadrique considéré comme étant la source ponctuelle $\mbf{L}$, et projetons ce point par rapport à la pose de la caméra réelle sur le maillage en entrée.

%=============================================================================
\section{Résultats expérimentaux} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:experimental_results}
% =============================================================================

Dans cette section, la prédiction de spécularité est testée sur des données synthétiques et réelles pour évaluer les améliorations par rapport au modèle JOLIMAS primal présenté au chapitre \ref{chapitre:primal_jolimas}, la sensibilité du modèle aux changements de courbure et la robustesse de notre méthode à un point d'intensité maximal bruité. La prédiction de spécularité est évaluée en utilisant la distance 2D entre les contours de la spécularité et l'ellipse prédite comme définie dans le chapitre précédent \ref{chapitre:primal_jolimas}. Cette erreur de prédiction est décrite en tant que pourcentage en calculant l'erreur moyenne par point de contour comparée à la taille de l'image.

\subsection{Comparaison avec JOLIMAS primal}
Nous utilisons une séquence comportant 300 images illustrée à la figure  \ref{fig:curvature_seq}. Dans cette séquence, une surface plane est courbée progressivement afin d'évaluer la fonctionnalité de notre modèle dual sur des surfaces planes et convexes. Pour chaque image, nous reconstruisons une quadrique à partir de 6 points de vue et nous calculons la distance 2D entre la spécularité prédite et la spécularité détectée. Notre méthode a une erreur moyenne de $1\%$ des pixels en comparaison avec JOLIMAS primal qui accumule $33\%$ d'erreur par ellipse.


\subsection{Sensibilité aux changements de courbure}
La forme d'une spécularité varie en fonction des changements géométriques et plus particulièrement les changements de courbure. Il est difficile de prédire de façon précise la spécularité pour un nouveau point de vue avec un changement de courbure  de la scène. En utilisant notre séquence précédente, nous avons testé la sensibilité de notre méthode aux changements de courbure en reconstruisant une quadrique à partir de la première image (surface plane) et en prédisant la spécularité pour toutes les images. Même si l'erreur augmente, l'information fournie par la prédiction reste cohérente avec une erreur moyenne de $7\%$ comme illustré à la figure \ref{fig:synt_curvature}.


\begin{figure}[!ht]
\centering
\subfigure[]
{
    \includegraphics[width=\linewidth]{curvature_seq.png}
    \label{fig:curvature_seq}
}
\subfigure[]
{
    \includegraphics[width=\linewidth]{primal_vs_dual2.pdf}
    \label{fig:synt_curvature_plot}
}
\caption{Comparaison entre JOLIMAS primal et notre modèle JOLIMAS dual. Dans cette séquence de synthèse, la courbure augmente progressivement à chaque image comme illustré dans (a). En utilisant 6 poses de caméra, les deux modèles primal et dual sont reconstruits et comparés en utilisant la distance 2D entre la prédiction de spécularité et les contours de la spécularité détectée. Notre approche duale réalise de meilleurs résultats que JOLIMAS primal avec une erreur moyenne de $1\%$  par ellipse comparé à une erreur de $33\%$ par ellipse en moyenne pour JOLIMAS primal. Nous testons également la prédiction de spécularité de notre modèle dual en reconstruisant une quadrique sur une surface plane (première image) et en l'utilisant pour les changements de courbure restants. Même si l'erreur croît pour chaque image, la prédiction de spécularité reste fiable avec une erreur relativement faible ($7\%$ en moyenne).}
\label{fig:synt_curvature}
\end{figure}



\subsection{Prédiction de spécularité sur des données réelles}
\label{sec:prediction_de_specularite}
Pour les séquences réelles, des expériences qualitatives sont réalisées sur la prédiction de spécularité en comparant l'ellipse prédite avec les contours de la spécularité associée pour chaque surface présentant des spécularités et avec la prédiction de spécularité de JOLIMAS primal. 
\paragraph{Contexte.}
Nous choisissons différents objets avec des courbures et matériaux variés sous différentes conditions de lumière. Pour les séquences de la réplique de fusée, du mug et du vase jaune, les images ont une résolution de $1280 \times 720$. Les poses de caméra sont calculées à partir d'une des variantes \cite{tamaazousti2011nonlinear, tamaazousti2011real, gay2012mobile, besbes2012interactive} du framework SLAM contraint \cite{tamaazousti2016constrained} proposé dans la thèse de Mohamed \cite{tamaazousti2013ajustement}. Plus spécifiquement, nous utilisons une amélioration de celui-ci adapté aux objets courbes de \cite{loesch2015generic}. Cette méthode de SLAM utilise le maillage reconstruit préalablement par le scanner HandySCAN 3D. Pour la séquence de billard, les images ont une résolution de $640 \times 480$. Pour cette séquence, les poses de caméra sont restituées par le logiciel Agisoft PhotoScan\footnote{\url{www.agisoft.com}}. La détection de spécularité est fournie par notre méthode de détection présentée dans l'annexe \ref{annexe:specularity_detection} en tant qu'image en niveau de gris. Nous utilisons que 6 images pour reconstruire la quadrique pour chaque séquence.

L'ensemble des résultats est illustré sur les figures \ref{fig:teaser} et \ref{fig:sequences}. Un résumé des résultats de notre modèle dual comparé au modèle primal est donné par la table \ref{tab:real_res}.

\begin{figure}[!ht]
   \centering	   
      \subfigure[]
	  {
	      \includegraphics[width=0.465\linewidth]{neon_rocket}
	  }   
      \subfigure[]
	  {
	      \includegraphics[width=0.473\linewidth]{spot_vase.png}
	  }   
	  \caption{Prédiction de spécularité sur deux surfaces non-planes. Sous l'hypothèse que les spécularités ont une forme elliptique sur les surfaces convexes, nous reconstruisons une quadrique dont la projection perspective correspond aux spécularités pour de nouveaux points de vue. Une quadrique est créée pour chaque surface convexe et chaque source de lumière. (a) présente une séquence réelle d'une réplique de fusée (au milieu) éclairée par un néon (en haut). Dans (b), nous utilisons une ampoule (en haut) pour illuminer un vase en verre (au milieu). Notre modèle a la capacité de prédire les spécularités (en bas) sur les différentes parties de la fusée et du vase pour de nouveaux points de vue (ellipses bleues).}
	  \label{fig:teaser}
\end{figure}

\paragraph{Réplique de fusée.}
Dans cette séquence comportant 1410 images, une réplique de fusée en métal est illuminé par un néon. Comme illustré à la figure \ref{fig:acd2}, notre maillage de la fusée est divisé en 7 morceaux convexes. Cependant, seulement 3 morceaux convexes sont utilisés car les pièces restantes ne présentent pas de spécularité. Nous atteignons une précision de 2.1\% au niveau de l'erreur de prédiction comparée à $32.8\%$ pour le modèle primal.

\paragraph{Mug.}
Pour cette séquence comportant 300 images, un mug en porcelaine est illuminée par 2 sources de lumière : une lampe de bureau et un néon différent de celui utilisé pour la séquence de la fusée. Notre méthode est capable de prédire les deux spécularités précisément avec une erreur de prédiction de 1.3\% puisque la courbure de l'objet d'intérêt est constant. JOLIMAS primal est capable de prédire les spécularités avec la taille appropriée mais avec une mauvaise position présentant une erreur moyenne de $18.3\%$.

 
\paragraph{Vase jaune.}
Dans cette séquence de 1900 images, un vase jaune en verre est illuminé par une lampe de bureau. Cette séquence est particulièrement difficile du fait de la symétrie de l'objet rendant l'estimation de la pose de caméra propice aux erreurs. De plus, les spécularités sur le vase ont une petite taille rendant le raffinement de la quadrique difficile. Cependant, nous arrivons à obtenir de bons résultats avec une erreur de prédiction de l'ordre de 1.9\% comparée à $35.2\%$ pour le modèle primal. Cet objet est divisé en 7 morceaux convexes comme illustré sur la figure \ref{fig:acd}.


\paragraph{Billard.}
Dans cette séquence de 415 images, trois boules de billards sont éclairées par deux sources de lumière : une lampe de bureau et une lampe de type ampoule au plafond. Cette séquence est également difficile à cause de la petite taille des spécularités. JOLIMAS dual obtient une précision de $1.1\%$ comparée à $51.4\%$ pour le modèle primal.

\begin{figure*}[!ht]
   \centering	   
    \includegraphics[width=\linewidth]{pred.png}
	  \caption{Prédiction de spécularité sur des séquences réelles avec différentes conditions de lumière et pour différentes courbures. Dans les images de la première ligne, une réplique de fusée est illuminée par un néon. Nous prédisons 3 spécularités précisément en utilisant JOLIMAS dual à droite contrairement à JOLIMAS primal (au centre) qui échoue en termes de position et de forme de spécularité prédite. Dans la deuxième ligne, un mug, illuminé par une lampe de bureau et une lampe néon, est utilisé pour tester la capacité de notre modèle à prédire plusieurs sources de lumière de forme et d'intensité différentes. Pour cet objet, notre résultat est particulièrement précis grâce à la constance de la courbure de l'objet. JOLIMAS primal parvient à prédire correctement l'échelle des spécularités mais avec des mauvaises positions. Dans la troisième ligne, nous utilisons un vase illuminé par une lampe de bureau. L'objet comporte 7 parties convexes, ce qui donne 7 spécularités. Dans la dernière ligne, nous utilisons trois boules de billard illuminées par une lampe de bureau et une lampe de type ampoule au plafond. Ces deux objets sont particulièrement difficiles à traiter à cause des erreurs de pose de la caméra. En effet, notre méthode de localisation rencontre des difficultés à gérer des objets symétriques et notre détecteur de spécularité est limité par la petite taille des spécularités qui apparaissent les surfaces des objets.}
	  \label{fig:sequences}
\end{figure*}

\begin{table}[h!] 
\caption{Validation empirique de notre modèle et sa capacité à prédire les spécularités dans les images pour 4 séquences réelles présentées à la figure \ref{fig:teaser} et \ref{fig:sequences}. Pour des courbures et sources de lumière variées, notre méthode fournit des résultats précis en termes de prédiction de spécularité en comparaison de JOLIMAS primal.}
  \centering
  \begin{tabular}{c|c|c|}
      \cline{2-3}
           & \multicolumn{2}{c|}{\specialcell{Erreur de prédiction (distance 2D en \%)}} \\
      \hline
        \multicolumn{1}{|c|}{Sequence} &   \hspace{0.75em} Primal  \hspace{0.75em} & Dual (notre méthode) \\
      \hline
      \multicolumn{1}{|c|}{\specialcell{Fusée}} & 32.8 & 2.1 \\
      \hline
      \multicolumn{1}{|c|}{\specialcell{Mug}} & 18.3 & 1.3 \\
      \hline
      \multicolumn{1}{|c|}{\specialcell{Vase}}    & 35.2 & 1.9 \\
      \hline
      \multicolumn{1}{|c|}{\specialcell{Boule de billard}}    & 51.4 & 1.1 \\
      \hline
  \end{tabular}
 
  \label{tab:real_res}
\end{table}

%=============================================================================
\section{Limites de l'approche} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:limites_de_lapproche}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% =============================================================================
Notre modèle dual de JOLIMAS apporte une amélioration significative par rapport à JOLIMAS primal mais rencontre quelques limites et présente quelques cas difficiles. La limitation principale de JOLIMAS dual est le fait qu'il faut reconstruire une quadrique par surface convexe et par source de lumière. Ceci pourrait être vu comme une incohérence dans le modèle et peut être inefficace en matière de temps d'exécution pour des objets plus complexes comportant de nombreuses parties convexes. Il est plus cohérent et efficace d'avoir une quadrique par source de lumière pour toutes les surfaces convexes à la fois. Dans l'exemple du vase illustré aux figures \ref{fig:teaser}, nous utilisons les sept spécularités pour reconstruire la quadrique associée à la source de lumière et pour une seule image. A proprement parler, JOLIMAS dual ne permet pas cependant ce type de reconstruction car notre modèle ne gère pas les changements de courbure. En termes d'images, il faut que les spécularités observées respectent la géométrie épipolaire. En pratique, nous avons vu que des variations légères de la courbure de la surface peuvent être gérées par JOLIMAS dual pour des surfaces lisses. Notons que pour des changements plus importants transformant une surface convexe en concave, nous ne pouvons pas gérer le changement topologique de la forme de la spécularité car il est difficile de modéliser clairement ce phénomène par une projection de quadrique. Un exemple de ce cas est illustré à la figure \ref{fig:hard_case2}.
Notre modèle est mis en échec lorsque la surface en question est constituée de différents matériaux. Ce cas va provoquer un changement d'échelle de la spécularité lorsqu'elle se déplacera d'un matériau à un autre et ainsi impactera négativement la reconstruction de quadrique de notre modèle. Un exemple de ce cas est illustré à la figure \ref{fig:hard_case1}

\begin{figure}[!ht]
   \centering	  
        \subfigure[]
        {
            \includegraphics[width=0.47\linewidth]{hardcase1.png}
            \label{fig:hard_case1}
        }
        \subfigure[]
        {
            \includegraphics[width=0.47\linewidth]{hardcase2.png}
            \label{fig:hard_case2}
        }
	  \caption{Cas difficiles pour JOLIMAS dual. Dans (a), nous montrons que la spécularité est affectée par le matériau de la surface en termes d'échelle même si la courbure est similaire sur les deux objets (boules de noël). Dans ce contexte, les ellipses associées aux spécularités ne respecteront pas la géométrie épipolaire. Dans (b), nous illustrons le cas d'un extincteur à incendie présentant des changements de courbure conséquents, ce qui va affecter la forme de la spécularité. Dans ce cas précis, nous ne sommes pas en mesure de prédire correctement la spécularité en termes d'échelle et de position.}
	  \label{fig:hard_cases}
\end{figure}

%================================================================================
\section{Conclusion et discussion}            %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:conclusion_dual}		%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%================================================================================
\paragraph{Discussion.}
Nos travaux futurs s'intéresseront à l'étude de l'impact des changements de rugosité et de courbure sur les spécularités. Pendant la reconstruction de la quadrique, il serait judicieux d'inclure car ces deux éléments qui impactent fortement  la forme de la spécularité. Pour gérer ces changements de courbures, il serait intéressant de trouver une solution analytique reliant la courbure de la surface à la forme de la spécularité, proche des travaux de \cite{blake1988geometry}. Nous verrons l'avancement de cette étude dans le chapitre suivant \ref{chapitre:modele_general}. De plus, il serait intéressant d'étudier les matériaux et le rapport qu'ils ont sur la forme de la spécularité. Dans le modèle dual, la reconstruction est limitée à un matériau spécifique car la forme de la spécularité est fortement influencée par le type de matériau. Une première approche serait d'utiliser des méthodes de segmentation de matériaux comme \cite{bell2015material, georgoulis2016delight} pour signaler à notre algorithme à quel moment la spécularité va changer de forme. Il serait intéressant d'utiliser un algorithme d'apprentissage sur une base de données d'images de spécularité de différents matériaux sous divers types de sources de lumière et diverses intensités pour prédire au mieux les changements à appliquer à la spécularité pour correspondre au matériau actuel. Il pourrait être intéressant de comparer notre prédiction de spécularité aux contours de spécularité observés afin d'apprendre un motif de rugosité (carte des normales appelée communément \textit{normal map} ou placage de surface appelé communément \textit{bump map}) et inclure ces éléments dans le processus de prédiction de spécularité.

\paragraph{Conclusion.}
Nous avons traité le besoin de prédiction de spécularité pour les applications de réalité augmentée et de vision par ordinateur en présentant un nouveau modèle géométrique de forme de spécularité appelé JOLIMAS dual.  Ce modèle est capable de prédire la forme d'une spécularité sur des surfaces planes mais également sur des surfaces convexes. Il étend JOLIMAS primal sous l'hypothèse que les spécularités conservent une forme elliptique sur une surface convexe. L'idée générale du modèle est qu'il représente une spécularité en tant qu'image réfléchie de la source de lumière sur une surface spéculaire ayant un comportement proche de celui d'un miroir. Cette source de lumière virtuelle peut être modélisée par une quadrique dont la projection perspective correspond à la forme de la spécularité pour les points de vue existants et nouveaux en fonction de la pose de la caméra. Notre approche précédente, JOLIMAS primal, présentée dans le chapitre \ref{chapitre:primal_jolimas} était limitée aux surfaces planes. Pour des surfaces non-planaires, les ellipses correspondant aux spécularités ne sont pas épipolairement consistantes, ce qui met en échec JOLIMAS primal. En utilisant une représentation de caméra virtuelle à partir d'un point spécifique de la spécularité (le point d'intensité maximale), qui suit la loi de réflexion en optique et qui n'est pas affecté par la distorsion induite par la courbure de la surface. Cependant, le calcul de ce point n'est pas trivial en raison de la présence de bruit dans les poses de caméra et dans les normales des maillages. Pour toutes ces raisons, nous avons implémenté une méthode d'estimation du point le plus intense respectant les règles de l'optique. Pour s'assurer de la généricité de notre modèle, nous utilisons une décomposition convexe approximative pour diviser le maillage en morceaux convexes. Afin de prédire chaque spécularité, nous reconstruisons une quadrique pour chaque morceau convexe et chaque source de lumière. La spécularité prédite (en tant qu'ellipse) est obtenue en projetant la quadrique reconstruite en utilisant la pose de caméra virtuelle du nouveau point de vue. Notre prédiction de spécularité a été évaluée en termes de robustesse et de précision sur des séquences synthétiques et réelles. Nous avons testé notre modèle dans des contextes variés avec plusieurs sources de lumière et plusieurs objets.
Ce chapitre a fait l'objet de deux publications internationales ISMAR \citeyearpar{morgand2017multiple}, d'une édition spéciale dans TVCG et d'une publication nationale ORASIS \citeyearpar{morgand2017modele}.
