\chapter*{Conclusion et perspectives}
\label{chapitre:conclusion}
\defineHeaderForStarredChapter[Conclusion et perspectives]
\addcontentsline{toc}{chapter}{Conclusion et perspectives}
\graphicspath{{images/conclusion/}}

\section*{Travaux réalisés}
% ==========================================================================================================================================
L'objectif principal de cette thèse était de proposer une solution de modélisation des sources de lumière d'une scène à l'aide d'une méthode de localisation de type SLAM contraint. Cette modélisation vise à améliorer le rendu des applications de réalité augmentée en ajoutant le contexte lumineux lorsqu'un objet virtuel est inséré dans un flux vidéo. Cependant, le problème de modélisation de l'illumination est en l'état mal posé et extrêmement complexe. Afin de proposer une solution à ce problème, nous avons, dans un premier temps, analysé les propriétés des différentes traces de lumière comme les ombres et les spécularités. Une ombre est produite quand un autre objet obstrue la lumière émise par une source lumineuse, créant une diminution de l'intensité reçue par cette surface. Cette variation d'intensité est généralement associée à la notion de \textit{Shading} en anglais. Une spécularité correspond à la réflexion d'une source de lumière sur une surface réfléchissante donnant une information cruciale sur la position de la source de lumière. De plus, nous avons constaté que pour des surfaces réfléchissantes planes et convexes, ces spécularités prennent une forme elliptique. De ce constat, nous avons émis l'hypothèse que ces spécularités peuvent être décrites par la projection perspective d'une quadrique. Cette quadrique permet de fournir la forme des spécularités pour n'importe quel point de vue, mais également de donner de nombreuses informations sur les sources de lumière (forme, position). Nous proposons un modèle géométrique novateur par rapport aux approches photométriques. Notre modèle reconstruit une quadrique à partir des ellipses calculées sur les contours des spécularités détectées dans l'image.

Dans un premier temps, dans une version appelée JOLIMAS primal, nous avons posé les bases de notre modèle dans le contexte plus restreint des surfaces planes. Dans cette version, nous avons implémenté la reconstruction de quadriques à partir d'ellipses calculées à partir des spécularités. Après cette première reconstruction, nous utilisons un processus de raffinement non-linéaire de la quadrique qui minimise la distance entre les ellipses issues de la projection de la quadrique et des contours de spécularités observés dans les images. Ce modèle a été utilisé pour une application de \textit{retexturing} en utilisant une fonction d'intensité gaussienne qui a donné des résultats prometteurs en matière de synthèse de spécularités.

En second lieu, nous avons mis en \oe{}uvre une nouvelle itération de JOLIMAS sous une forme duale pour lever la contrainte de géométrie plane et l'étendre aux surfaces courbes. En effet, lorsqu'une surface est courbée, la reconstruction de quadrique échoue, car les contours des spécularités ne suivent pas la géométrie épipolaire. Afin de résoudre ce problème, nous utilisons un système de caméras virtuelles qui sont calculées à partir des normales aux points d'intensité maximale des spécularités. Dans ce formalisme de caméras virtuelles, les contours de spécularités suivent la géométrie épipolaire. Ces caméras virtuelles permettent de réutiliser le pipeline de reconstruction de quadrique de JOLIMAS primal et d'augmenter la généricité du modèle. Nous avons également amélioré l'application de \textit{retexturing} en reconstruisant un terme diffus qui nous permet de synthétiser des variations d'intensité et des ombres, ce qui augmente le réalisme de notre rendu.

Dans un troisième temps, nous avons proposé un modèle général appelé JOLIMAS canonique permettant de prédire les spécularités sur une surface pour n'importe quelle courbure. Dans cette itération de JOLIMAS, nous avons fait le lien entre courbure et spécularité en utilisant une formule décrivant le terme spéculaire du modèle d'illumination de \cite{cook1982reflectance}. En ajoutant un prétraitement des contours de la spécularité, nous sommes capables de transformer les contours de la spécularité sur la surface courbe en spécularité sur une surface plane (dans ce cas, le plan étant tangent au point d'intensité maximale). En utilisant le formalisme de caméra virtuelle de JOLIMAS dual et le pipeline de reconstruction de quadrique de JOLIMAS primal, nous fournissons un modèle de prédiction de spécularité générique, en temps réel et qui requiert un nombre d'images assez faible (au moins trois images et en moyenne six images).

Nous avons testé ces différentes itérations sur de nombreuses séquences synthétiques et réelles afin d'évaluer la qualité de la prédiction de spécularité ainsi que la qualité du rendu pour le \textit{retexturing} en réalité augmentée.


\section*{Perspectives}
\label{sec:perspectivesDeNosTravaux}
% ==========================================================================================================================================
Dans cette thèse, nous avons mis l'accent sur une application de \textit{retexturing} utilisant la prédiction de spécularité de JOLIMAS. Cependant, n'utiliser JOLIMAS que pour une amélioration du rendu est réducteur, car ce modèle fournit des informations très complètes en termes de géométrie qui peuvent profiter à de nombreuses applications comme évoquées ci-après.

\paragraph{Amélioration de la pose de caméra.}
De façon similaire à \cite{lagger20083d} (illustré à la figure \ref{fig:lagger}), nous pouvons utiliser les spécularités et plus particulièrement notre prédiction de spécularité pour raffiner davantage la pose de la caméra. En effet, dans un processus d'ajustement de faisceaux qui est une méthode classique de raffinement non-linéaire des points 3D reconstruits et de la pose de caméra, l'erreur de reprojection entre les points 3D projetés et leur correspondance 2D dans l'image doit être minimisée. Il serait envisageable de rajouter à la fonction de coût une minimisation de la distance point/point entre l'ellipse prédite par JOLIMAS et les contours de la spécularité détectée dans les images.

\begin{figure}
    \centering
    \includegraphics[width=0.9\linewidth]{lagger.png}	
    \caption{Utilisation des spécularités pour raffiner la position de la pose de caméra et respectivement l'alignement du maillage du modèle de boite en métal. Images extraites de l'article de \cite{lagger20083d}.}
	\label{fig:lagger}
\end{figure}

\paragraph{Géométrie à partir de la spécularité.}
Quelques travaux ont tenté de faire le lien entre courbure et spécularité comme \cite{healey1988local, blake1988geometry} en prenant les informations d'intensité et de position de la spécularité comme primitives de reconstruction de surface. Nous avons eu l'occasion pendant nos travaux d'étudier ce lien entre forme/position de la spécularité et courbure. Une extension possible serait de reconstruire le modèle JOLIMAS à partir d'une surface dont la géométrie est connue et de calculer la courbure d'une autre surface en comparant la forme de la spécularité détectée avec la spécularité prédite par la quadrique.
\paragraph{\textit{Retexturing} plus avancé.}
De façon plus évidente qu'avec le \textit{shading}, les spécularités mettent davantage en évidence la micro-géométrie/rugosité d'une surface. Il serait intéressant de reconstruire une carte de normales associée à une surface afin d'améliorer le rendu de notre \textit{retexturing}. En effet, la micro-géométrie d'une surface a un impact conséquent sur la forme de la spécularité et sur le réalisme.
 
\paragraph{Initialisation des modèles d'illumination locale.}
De façon semblable à notre application de \textit{retexturing}, il est pertinent d'utiliser la quadrique permettant la prédiction de spécularité comme position initiale de la source de lumière dans un modèle d'illumination locale de type Phong, Blinn-Phong ou encore Cook-Torrance. En général, il est difficile de calculer simultanément tous les paramètres des modèles, car certains sont de nature photométrique (intensité, couleur) alors que d'autres sont de nature géométrique (position de la lumière). De plus, la forme de la quadrique reconstruite par JOLIMAS donne des indications intéressantes sur le type de lumières présentent dans la scène comme les néons ou les spots. Il serait intéressant de proposer une fonction d'intensité qui prend en compte la forme de la quadrique.

\paragraph{Utilisation en réalité diminuée.}
Récemment, des approches comme \cite{said2017image} ont mis en évidence l'importance de gérer les spécularités dans le domaine de la réalité diminuée comme illustré à la figure \ref{fig:diminished}. En effet, pour les applications de réalité diminuée, l'objectif est de supprimer un objet d'intérêt dans une séquence vidéo en temps réel et de façon naturelle. En présence de spécularités dans une scène, il peut être difficile de supprimer un objet d'une surface réfléchissante de façon cohérente si les spécularités retirées par le processus d'\textit{inpainting} ne sont pas synthétisées à nouveau. De plus, si une spécularité se déplace sur la zone d'\textit{inpainting}, il ne faut pas que celle-ci disparaisse pour des raisons de cohérence visuelle.
\begin{figure}
    \centering
    \subfigure[]
    {
        \includegraphics[width=0.45\linewidth]{dr1.png}	
    }
    \subfigure[]
    {
        \includegraphics[width=0.45\linewidth]{dr2.png}	
    }
    \caption{Exemple de prise en compte des spécularités dans une application de réalité diminuée. Dans cette figure, une clé USB est supprimée d'une table en bois en présence d'une spécularité. Il est important ici de synthétiser la spécularité lorsqu'elle se déplace sur la zone où la clé USB a été supprimée pour assurer une cohérence visuelle. Images extraites de \cite{said2017image}.}
	\label{fig:diminished}
\end{figure}
Pour pallier ce problème de façon générale, il pourrait être utile d'utiliser le modèle JOLIMAS et sa prédiction de spécularité pour synthétiser les spécularités de la même manière que dans notre application de \textit{retexturing}.

\paragraph{Identification des matériaux.}
Dans notre modèle JOLIMAS, de nombreux paramètres sont abstraits par la forme de spécularité (intensité, ouverture du capteur, rugosité, réflectance). Après avoir reconstruit un modèle JOLIMAS pour une surface donnée, nous n'avons pas d'indications sur la réflectance ou la rugosité. Lors de nos expériences, nous avons remarqué que la rugosité et la réflectance avaient un impact sur l'échelle de la spécularité. Ainsi, lorsque nous prédisons la spécularité sur une surface de matériau différent de celui de la surface où la reconstruction de la quadrique a été réalisée, nous pouvons calculer un coefficient qui inclut la rugosité et la réflectance correspondant à une différence d'échelle entre la forme des deux spécularités. Nous pourrions également utiliser des méthodes d'apprentissage à partir d'une base de données de réflectance associée à différents matériaux comme celle de MERL \cite{matusik2003data}. A noter qu'un des problèmes compliqués en apprentissage profond 
est d'apprendre des représentations universelles (capable de gérer un maximum de modalité, 
de domaine visuel et de domaine sémantique) \cite{tamaazousti2017learning, tamaazousti2017mucale}.